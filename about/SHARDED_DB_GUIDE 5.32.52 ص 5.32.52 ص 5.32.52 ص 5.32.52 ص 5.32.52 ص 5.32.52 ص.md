# ุฏููู ุงุณุชุฎุฏุงู ูุธุงู ููุงุนุฏ ุงูุจูุงูุงุช ุงูููุณูุฉ

## โก ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### โ ูุง ุชู ุชุทุจููู:
1. **ุชูุณูู ุชููุงุฆู:** ูู 1000 ูุชุงุจ ูู ูุงุนุฏุฉ ูููุตูุฉ
2. **ุจุญุซ ูุชูุงุฒู:** ุงูุจุญุซ ูู ุฌููุน ุงูููุงุนุฏ ุจุงูุชูุงุฒู (ุณุฑุนุฉ 5-10x)
3. **ุชูุฒูุน ุฐูู:** ุฅุถุงูุฉ ุงููุชุจ ุชููุงุฆูุงู ูููุงุนุฏุฉ ุงูููุงุณุจุฉ
4. **ูุงุฌูุฉ ููุญุฏุฉ:** ููุณ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู - ูุง ุชุบููุฑ!

---

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### 1๏ธโฃ ุฅุฐุง ูุงูุช ุนูุฏู ูุงุนุฏุฉ ุจูุงูุงุช ูุฏููุฉ (shamela.db)

#### ุงูุฎุทูุฉ 1: ุชุฑุญูู ุงูุจูุงูุงุช
```bash
python migrate_to_sharded.py
```

ุณูููู ุจู:
- โ ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงููุฏููุฉ
- โ ุฅูุดุงุก ููุงุนุฏ ููุณูุฉ ุฌุฏูุฏุฉ ูู `data/shards/`
- โ ููู ุฌููุน ุงููุชุจ ูุงูุตูุญุงุช
- โ ุงูุชุญูู ูู ุตุญุฉ ุงูููู

**ุงููุฏุฉ ุงููุชููุนุฉ:**
- 1,000 ูุชุงุจ: ~5 ุฏูุงุฆู
- 10,000 ูุชุงุจ: ~30 ุฏูููุฉ
- 30,000 ูุชุงุจ: ~1-2 ุณุงุนุฉ

---

### 2๏ธโฃ ุฅุฐุง ููุช ุชุจุฏุฃ ูู ุงูุตูุฑ

#### ุงุณุชูุฑุงุฏ ูุชุจ ุฌุฏูุฏุฉ:
```bash
python import_books.py
```

ุณูููู ุชููุงุฆูุงู ุจู:
- โ ุฅูุดุงุก ุฃูู ูุงุนุฏุฉ `shard_0000.db`
- โ ุฅุถุงูุฉ ุงููุชุจ ุชููุงุฆูุงู
- โ ุฅูุดุงุก ููุงุนุฏ ุฌุฏูุฏุฉ ุนูุฏ ุงูุญุงุฌุฉ

---

## ๐ ุงูุจููุฉ ุงูุฌุฏูุฏุฉ

```
data/
  โโโ master.db              # ูุงุนุฏุฉ ุงูุชูุณูู (ุตุบูุฑุฉ ุฌุฏุงู)
  โโโ shards/
      โโโ shard_0000.db     # ุงููุชุจ 1-1000
      โโโ shard_0001.db     # ุงููุชุจ 1001-2000
      โโโ shard_0002.db     # ุงููุชุจ 2001-3000
      โโโ ...
```

### ุญุฌู ูู ูุงุนุฏุฉ:
- **1000 ูุชุงุจ** = 3-5 ุบูุบุงุจุงูุช
- **ูุงุจู ูููุฑุงุกุฉ ุจุณูููุฉ** โ
- **ุจุญุซ ุณุฑูุน** โ

---

## ๐ป ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู

### ุงุณุชูุฑุงุฏ ูุชุจ ุฌุฏูุฏุฉ:

```python
# ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ (ุงูุชุฑุงุถูุฉ):
from converters.txt_converter import TXTConverter
from db.sharded_database import ShardedDB

# ุฅูุดุงุก ูุงุนุฏุฉ ููุณูุฉ
db = ShardedDB("data", books_per_shard=1000)
converter = TXTConverter(db, use_sharded=True)

# ุงุณุชูุฑุงุฏ ูุฌูุฏ ูุงูู
converter.convert_directory("data/txt_books")

# ุงููุชุจ ุชููุฒุน ุชููุงุฆูุงู!
db.close()
```

### ุงูุจุญุซ ูู ุฌููุน ุงููุชุจ:

```python
from db.sharded_database import ShardedDB

# ูุชุญ ุงููุธุงู ุงูููุณู
db = ShardedDB("data")

# ุจุญุซ ูุชูุงุฒู (ุณุฑูุน ุฌุฏุงู!)
results = db.search_books_parallel(
    query="ุงูุฅููุงู",
    limit=100,
    max_workers=4  # 4 ุนูููุงุช ูุชูุงุฒูุฉ
)

# ุนุฑุถ ุงููุชุงุฆุฌ
for result in results:
    print(f"ุงููุชุงุจ: {result['book_title']}")
    print(f"ุงููุงุนุฏุฉ: shard_{result['shard_number']:04d}")
    print(f"ุงูุตูุญุฉ: {result['page_number']}")
    print("-" * 50)

db.close()
```

### ุงูุญุตูู ุนูู ุฅุญุตุงุฆูุงุช:

```python
from db.sharded_database import ShardedDB

db = ShardedDB("data")
stats = db.get_statistics()

print(f"ุนุฏุฏ ุงูููุงุนุฏ: {stats['total_shards']}")
print(f"ุฅุฌูุงูู ุงููุชุจ: {stats['total_books']}")
print(f"ุฅุฌูุงูู ุงูุตูุญุงุช: {stats['total_pages']}")
print(f"ุงูุญุฌู ุงูุฅุฌูุงูู: {stats['total_size_mb']:.2f} ููุบุง")

print("\nุชูุฒูุน ุงููุชุจ:")
for shard_name, count in stats['books_per_shard'].items():
    print(f"  {shard_name}: {count} ูุชุงุจ")

db.close()
```

---

## ๐ฏ ุงููุฑู ุจูู ุงููุธุงู ุงููุฏูู ูุงูุฌุฏูุฏ

### ุงููุธุงู ุงููุฏูู (ูุงุนุฏุฉ ูุงุญุฏุฉ):
```python
from db.database import ShamelaDB

db = ShamelaDB("data/shamela.db")
book_id = db.add_book(...)
db.add_page(book_id, 1, content)
```

### ุงููุธุงู ุงูุฌุฏูุฏ (ููุณู):
```python
from db.sharded_database import ShardedDB

db = ShardedDB("data")
shard_num, book_id = db.add_book(...)  # ูุฑุฌุน ุฑูู ุงููุงุนุฏุฉ ุฃูุถุงู
db.add_page(shard_num, book_id, 1, content)
```

**ููุงุญุธุฉ:** ุฅุฐุง ุงุณุชุฎุฏูุช `TXTConverter`ุ ูู ุดูุก ูุชู ุชููุงุฆูุงู!

---

## ๐ ุฃููุงุน ุงูุจุญุซ ุงููุฏุนููุฉ

### 1. ุจุญุซ ูุชูุงุฒู ุนุงุฏู:
```python
results = db.search_books_parallel("ูููุฉ ุงูุจุญุซ", max_workers=4)
```

### 2. ุจุญุซ ูููุงุช ูุชูุงุฒู:
```python
results = db.search_word_parallel(
    query="ุงูุนูู",
    respect_diacritics=False,  # ุชุฌุงูู ุงูุชุดููู
    match_whole_letters=True,  # ูุทุงุจูุฉ ูุงููุฉ
    max_workers=4
)
```

### 3. ุจุญุซ ูู ุชุตููู ูุนูู:
```python
results = db.search_books_parallel(
    query="ุงูุฅููุงู",
    categories=["ุงูุนููุฏุฉ", "ุงูุญุฏูุซ"],
    max_workers=4
)
```

### 4. ุจุญุซ ูู ูุชุจ ูุญุฏุฏุฉ:
```python
# ูุงุฆูุฉ ูู (shard_number, book_id)
book_ids = [(0, 1), (0, 5), (1, 3)]
results = db.search_books_parallel(
    query="ุงูุจุญุซ",
    book_ids=book_ids,
    max_workers=4
)
```

---

## ๐ ููุงุฑูุฉ ุงูุฃุฏุงุก

### ูุจู (ูุงุนุฏุฉ ูุงุญุฏุฉ 100 ุบูุบุง):
```
โ ูุดู ูู ุงููุชุญ (ุชุฌูุฏ)
โ ุจุญุซ: 30-60 ุซุงููุฉ (ุฅู ูุฌุญ)
โ ุงุณุชููุงู RAM: 4-8 ุบูุบุง
```

### ุจุนุฏ (30 ูุงุนุฏุฉ ร 3.3 ุบูุบุง):
```
โ ูุชุญ ููุฑู
โ ุจุญุซ: 2-5 ุซูุงูู (ุจุญุซ ูุชูุงุฒู)
โ ุงุณุชููุงู RAM: 500 ููุบุง - 1 ุบูุบุง
```

**ุงูุณุฑุนุฉ:** **10-20x ุฃุณุฑุน** ๐

---

## ๐๏ธ ุญู ุงููุดุงูู

### ุงููุดููุฉ: "ุงููุงุนุฏุฉ X ุบูุฑ ููุฌูุฏุฉ"
```python
# ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ุฑูู ุงููุงุนุฏุฉ ุงูุตุญูุญ
shard_num, book_id = db.add_book(...)
db.add_page(shard_num, book_id, ...)  # ุงุณุชุฎุฏู ููุณ shard_num
```

### ุงููุดููุฉ: "ุจุทุก ูู ุงูุจุญุซ"
```python
# ุฒุฏ ุนุฏุฏ ุงูุนูููุงุช ุงููุชูุงุฒูุฉ
results = db.search_books_parallel(
    query="...",
    max_workers=8  # ุจุฏูุงู ูู 4
)
```

### ุงููุดููุฉ: "ุงููุชุจ ูู ุชููุฒุน ุจุงูุชุณุงูู"
- ูุฐุง ุทุจูุนู! ุงูุชูุฒูุน ูุชู ุญุณุจ ุชุฑุชูุจ ุงูุฅุถุงูุฉ
- ูู ูุงุนุฏุฉ ุชุญุชูู ุนูู 1000 ูุชุงุจ ูุญุฏ ุฃูุตู
- ุงููุงุนุฏุฉ ุงูุฃุฎูุฑุฉ ูุฏ ุชุญุชูู ุนูู ุฃูู

---

## ๐ ูุตุงุฆุญ ููุฃุฏุงุก ุงูุฃูุซู

### 1. ุงุณุชุฎุฏุงู ุงูุจุญุซ ุงููุชูุงุฒู ุฏุงุฆูุงู:
```python
# โ ุณุฑูุน
results = db.search_books_parallel(query, max_workers=4)

# โ ุจุทูุก (ูุง ุชุณุชุฎุฏูู ููุจุญุซ ูู ุฌููุน ุงูููุงุนุฏ)
for shard in db.shards.values():
    results.extend(shard.search_books(query))
```

### 2. ุชุญุฏูุฏ ูุทุงู ุงูุจุญุซ:
```python
# ุฃุณุฑุน - ุจุญุซ ูู ุชุตููู ูุงุญุฏ
results = db.search_books_parallel(
    query="...",
    categories=["ุงูุนููุฏุฉ"]
)
```

### 3. ุชุญุฏูุฏ ุนุฏุฏ ุงููุชุงุฆุฌ:
```python
# ุฃุณุฑุน - ูุชุงุฆุฌ ุฃูู
results = db.search_books_parallel(
    query="...",
    limit=50  # ุจุฏูุงู ูู 1000
)
```

---

## ๐ ุงูุชุฑููุฉ ูู ุงููุธุงู ุงููุฏูู

### ุงูุฎุทูุงุช:

1. **ูุณุฎ ุงุญุชูุงุทู:**
```bash
cp data/shamela.db data/shamela.db.backup
```

2. **ุชุฑุญูู ุงูุจูุงูุงุช:**
```bash
python migrate_to_sharded.py
```

3. **ุงูุชุญูู:**
```bash
# ุณูุนุฑุถ ุงูุณูุฑูุจุช ุฅุญุตุงุฆูุงุช ุงูููุงุฑูุฉ
```

4. **ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฌุฏูุฏ:**
```bash
python import_books.py  # ูุฅุถุงูุฉ ูุชุจ ุฌุฏูุฏุฉ
python main.py          # ุชุดุบูู ุงูุจุฑูุงูุฌ
```

### ูุงุฐุง ูุญุฏุซ ูููุงุนุฏุฉ ุงููุฏููุฉุ
- ุชุจูู ููุง ูู (ูุณุฎุฉ ุงุญุชูุงุทูุฉ)
- ูููู ุญุฐููุง ุจุนุฏ ุงูุชุฃูุฏ ูู ุตุญุฉ ุงูุชุฑุญูู

---

## โจ ุงูุฎูุงุตุฉ

### ุงูุชุบููุฑุงุช:
- โ **ููุณ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู** - ูุง ุชุบููุฑ ูู ุงููุงุฌูุฉ
- โ **ุชูุฒูุน ุชููุงุฆู** - ูุง ุชููู ุจุดุฃู ุงูุชูุณูู
- โ **ุจุญุซ ูุชูุงุฒู** - ุณุฑุนุฉ ุฃูุจุฑ 10x
- โ **ุงุณุชูุฑุงุฑ ูุงูู** - ูุง ูุฒูุฏ ูู ุงูุฃุนุทุงู

### ุงููุชูุฌุฉ:
๐ **ูุธุงู ุณุฑูุน ููุณุชูุฑ ูุฏุนู ููุงููู ุงููุชุจ!**

---

## ๐ ุงููุณุงุนุฏุฉ

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุชุญูู ูู ููู `SOLUTIONS_PROPOSAL.md`
2. ุฑุงุฌุน ุงูุฃูุซูุฉ ุฃุนูุงู
3. ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู `use_sharded=True` ูู ุงููุญูู

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** ุฃูุชูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ

