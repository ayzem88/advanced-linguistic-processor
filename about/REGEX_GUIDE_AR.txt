===============================================
دليل التعابير النمطية (Regular Expressions)
للبحث في النصوص العربية
===============================================

المكتبة المستخدمة: regex (نسخة محسّنة من re)
التوثيق الكامل: https://pypi.org/project/regex/

===============================================
1. الأساسيات
===============================================

.           أي حرف واحد (ما عدا السطر الجديد)
            مثال: ق.ل  →  قال، قتل، قبل

^           بداية السطر
            مثال: ^قال  →  قال في بداية السطر فقط

$           نهاية السطر
            مثال: والله$  →  والله في نهاية السطر

\           للهروب من الأحرف الخاصة
            مثال: \[  →  البحث عن [ حرفياً

|           أو (OR)
            مثال: قال|حدث  →  قال أو حدث

( )         مجموعة للتجميع
            مثال: (قال|حدث)نا  →  قالنا أو حدثنا

[ ]         مجموعة أحرف
            مثال: [قحك]ال  →  قال أو حال أو كال

[^ ]        أحرف ما عدا (NOT)
            مثال: [^ا]ل  →  أي حرف + ل ما عدا ال


===============================================
2. المكررات (Quantifiers)
===============================================

*           صفر أو أكثر
            مثال: قا*ل  →  قل، قال، قااال

+           واحد أو أكثر
            مثال: قا+ل  →  قال، قااال (لكن ليس قل)

?           صفر أو واحد (اختياري)
            مثال: قا?ل  →  قل أو قال

{n}         تكرار n مرة بالضبط
            مثال: قا{3}ل  →  قااال

{n,}        تكرار n مرة أو أكثر
            مثال: قا{2,}ل  →  قاال، قااال، ...

{n,m}       تكرار من n إلى m مرة
            مثال: قا{1,3}ل  →  قال، قاال، قااال

*?          أقل تكرار ممكن (lazy)
+?          أقل تكرار ممكن
??          


===============================================
3. أنماط خاصة للنصوص العربية
===============================================

[\u0600-\u06FF]         أي حرف عربي (الأساسية)
[\u0600-\u06FF]+        كلمة عربية كاملة

[\u064B-\u065F]         الحركات والتشكيل
[\u064B-\u065F]*        تشكيل اختياري

\p{Arabic}              أي حرف عربي (مكتبة regex فقط)
\p{Arabic}+             كلمة عربية

[\u0621-\u063A\u0641-\u064A]  الحروف العربية بدون تشكيل


===============================================
4. أمثلة عملية للبحث في النصوص العربية
===============================================

--- البحث عن كلمة محددة ---
\bالله\b                    كلمة "الله" كاملة
^قال                        سطر يبدأ بـ "قال"
والله$                      سطر ينتهي بـ "والله"


--- البحث مع احتمالات ---
(قال|حدثنا|أخبرنا)          قال أو حدثنا أو أخبرنا
حدثن[اي]                    حدثنا أو حدثني
[قحك]ال                     قال، حال، كال


--- البحث في الأسانيد ---
حدثنا.*عن.*                 حدثنا ... عن ...
قال.*رسول الله               قال ... رسول الله
عن [^\s]+ عن [^\s]+         عن فلان عن فلان


--- البحث مع التشكيل ---
قَالَ                        قال مع الفتح
[\u064B-\u065F]*قال[\u064B-\u065F]*   قال مع أو بدون تشكيل
ق[\u064B-\u065F]*ا[\u064B-\u065F]*ل[\u064B-\u065F]*   قال مع تشكيل اختياري بين الحروف


--- أنماط الأسماء والألقاب ---
أبو \w+                      أبو + اسم
ابن \w+                      ابن + اسم
عبد ال\w+                    عبد الله، عبد الرحمن، ...


--- البحث في الآيات ---
^\d+\.                       رقم الآية في البداية
﴿.*﴾                        نص بين قوسين مزخرفين
\[.*\]                       نص بين أقواس مربعة


--- البحث في التواريخ ---
\d+هـ                        سنة هجرية
\d{3,4}                      رقم من 3-4 أرقام (سنة)
توفي سنة \d+                 توفي سنة + رقم


--- البحث المتقدم ---
(?=.*قال)(?=.*حدث).*         سطر يحتوي قال و حدث معاً
^(?!.*قال).*$               سطر لا يحتوي على قال
قال(?=.*رسول الله)           قال متبوعة برسول الله في نفس السطر


===============================================
5. أمثلة متقدمة مع الشرح
===============================================

--- مثال 1: البحث عن راوٍ في السند ---
النمط: حدثنا (\w+) (?:بن|ابن) (\w+)
الشرح: حدثنا + اسم + بن/ابن + اسم
يطابق: حدثنا أحمد بن حنبل
        حدثنا محمد ابن إسماعيل


--- مثال 2: البحث عن آية ---
النمط: ﴿([^﴾]+)﴾
الشرح: أي نص بين ﴿ و ﴾
يطابق: ﴿إِنَّا أَعْطَيْنَاكَ الْكَوْثَرَ﴾


--- مثال 3: البحث عن حديث ---
النمط: قال رسول الله.*?[:.،]
الشرح: قال رسول الله حتى أول علامة ترقيم
يطابق: قال رسول الله صلى الله عليه وسلم:


--- مثال 4: استخراج سنة الوفاة ---
النمط: توفي سنة (\d{3,4})
الشرح: توفي سنة + 3-4 أرقام
يطابق: توفي سنة 241


--- مثال 5: البحث في المتن ---
النمط: ^[^:]+: (.+)$
الشرح: كل شيء قبل : ثم النص بعدها
يطابق: عن أبي هريرة: قال النبي


--- مثال 6: كلمات متتالية ---
النمط: \b\w+\s+\w+\s+\w+\b
الشرح: 3 كلمات متتالية
يطابق: قال رسول الله
        في ذلك اليوم


===============================================
6. أعلام (Flags) المستخدمة
===============================================

re.MULTILINE        ^ و $ لكل سطر (مفعّل افتراضياً)
re.DOTALL          . يشمل السطر الجديد (مفعّل افتراضياً)
re.UNICODE         دعم Unicode للعربية (مفعّل افتراضياً)
re.IGNORECASE      تجاهل حالة الأحرف


===============================================
7. نصائح مهمة للبحث في النصوص العربية
===============================================

1. استخدم \b بحذر مع العربية - قد لا يعمل كما متوقع
2. للبحث عن كلمة كاملة: (?<!\S)كلمة(?!\S)
3. التشكيل قد يعطّل البحث - استخدم [\u064B-\u065F]* بعد كل حرف
4. للبحث بدون تشكيل: أزل التشكيل من النص أولاً
5. استخدم \p{Arabic} بدل [\u0600-\u06FF] في مكتبة regex


===============================================
8. أمثلة مركبة للبحث المتقدم
===============================================

--- البحث عن حديث كامل ---
(?:قال|حدثنا|أخبرنا).*?(?:رسول الله|النبي).*?[:.،]
الشرح: بداية السند + ... + ذكر النبي + ... + نهاية الجملة


--- البحث عن اقتباس ---
"[^"]+"
الشرح: أي نص بين علامتي تنصيص


--- البحث عن رقم صفحة ---
\[ص:\s*\d+\]
\(صفحة \d+\)
الشرح: [ص: 123] أو (صفحة 123)


--- البحث عن عنوان ---
^[^\n]{1,100}:$
الشرح: سطر قصير ينتهي بنقطتين (عنوان)


--- استخراج الكلمات الطويلة ---
\b\p{Arabic}{7,}\b
الشرح: كلمات عربية من 7 أحرف أو أكثر


===============================================
9. أخطاء شائعة وحلولها
===============================================

❌ الخطأ: ^عنوان
   لا يطابق "عنوان" في وسط السطر
✅ الحل: ^\s*عنوان أو \bعنوان


❌ الخطأ: قال.*رسول
   يطابق من أول قال إلى آخر رسول (جشع)
✅ الحل: قال.*?رسول (غير جشع)


❌ الخطأ: [قال]
   يطابق ق أو ا أو ل منفردة
✅ الحل: قال أو (قال)


❌ الخطأ: عنوان الكتاب:
   لا يطابق إذا كان هناك مسافات
✅ الحل: عنوان\s+الكتاب\s*:


===============================================
10. أمثلة تفاعلية لتجربتها
===============================================

--- للتجربة في المكتبة ---

1. كلمة في بداية السطر:
   ^\s*قال

2. كلمة في نهاية السطر:
   والله\s*$

3. سلسلة أسانيد:
   حدثنا.*عن.*عن.*عن

4. أي رقم:
   \d+

5. تاريخ:
   \d{1,2}/\d{1,2}/\d{4}

6. كلمة بين كلمتين:
   قال\s+\w+\s+رسول

7. بداية فصل:
   ^الفصل\s+\w+

8. نص بين قوسين:
   \([^)]+\)

9. كلمات متعددة:
   (الله|الرحمن|الرحيم)

10. سطر كامل يحتوي:
    ^.*قال.*رسول.*$


===============================================
ملاحظات نهائية
===============================================

- في البرنامج، الأعلام MULTILINE و DOTALL و UNICODE مفعّلة تلقائياً
- للبحث في كل الكتاب: استخدم (?s) في بداية النمط
- للبحث سطر بسطر: استخدم ^ و $ عادي
- اختبر أنماطك على regex101.com أولاً

===============================================
للمزيد من المعلومات
===============================================

توثيق regex: https://github.com/mrabarnett/mrab-regex
أمثلة تفاعلية: https://regex101.com/
دليل شامل: https://www.regular-expressions.info/

===============================================





