# ุฎุทุฉ ุงุณุชูุจุงู ุงูููุท ุงูุฌุฏูุฏ ููุนูููุงุช ุงููุชุงุจ

## ุงููุดููุฉ ุงูุญุงููุฉ
ุงููุธุงู ูุณุชุฎุฑุฌ ูุนูููุงุช ุงููุชุงุจ ูู ูููุงุช TXT ุจุงูุชูุณูู ุงูุชุงูู:
```
ุนููุงู ุงููุชุงุจ: ...
ุงููุคูู: ...
ุงูุชุตููู: ...
ุงูุณูุฉ: ...
```

ุงููุณุชุฎุฏู ูุฑูุฏ ุชุบููุฑ ุงูุชูุณูู (ุณูุญุฏุฏู ูุงุญูุงู).

---

## ๐ ุงูุฃูุงูู ุงูุชู ุชุชุนุงูู ูุน ูุนูููุงุช ุงููุชุงุจ

### 1. ุงูุงุณุชูุฑุงุฏ ูุงูุงุณุชุฎุฑุงุฌ
**ุงูููู:** `converters/txt_converter.py`
**ุงูุฏุงูุฉ:** `extract_metadata()` (ุงูุณุทูุฑ 35-114)

**ุงูุญููู ุงููุณุชุฎุฑุฌุฉ:**
- `ุนููุงู ุงููุชุงุจ:` โ `title`
- `ุงููุคูู:` โ `author`
- `ุงูุชุตููู:` โ `category`
- `ุงูุณูุฉ:` / `ุณูุฉ ุงููุดุฑ:` / `ุชุงุฑูุฎ ุงููุดุฑ:` โ `year`
- `ุนุฏุฏ ุงููููุงุช:` โ `word_count`
- `ุชูุงุฑูุฎ ุงูุฅุตุฏุงุฑ:` โ `publication_dates`

**ุงูููู ุงูุงูุชุฑุงุถูุฉ:**
- title: ุงุณู ุงูููู
- author: 'ูุคูู ุบูุฑ ูุนุฑูู'
- category: 'ูุชูุฑูุงุช'
- year: '0000'

---

### 2. ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### 2.1. ุฅุถุงูุฉ ุงููุชุงุจ
**ุงูููู:** `db/sharded_database.py`
**ุงูุฏุงูุฉ:** `add_book()` (ุงูุณุทุฑ 302)
```python
def add_book(self, title: str, author: str = None, category: str = None,
             word_count: int = None, publication_dates: str = None,
             publication_details: str = None, year: str = None, metadata: Dict = None)
```

**ุงูุฌุฏูู:** `book_shard_map`
```sql
CREATE TABLE book_shard_map (
    shard_number INTEGER NOT NULL,
    local_book_id INTEGER NOT NULL,
    title TEXT,
    author TEXT,
    category TEXT,
    ...
)
```

#### 2.2. ุงุณุชุฑุฌุงุน ูุนูููุงุช ุงููุชุงุจ
**ุงูููู:** `db/database.py`
**ุงูุฏุงูุฉ:** `get_book()` (ุงูุณุทุฑ 228 ู 803)
```python
SELECT id, title, author, category, pages_count, metadata
FROM books WHERE id = ?
```

**ุงูุฅุฑุฌุงุน:**
```python
{
    'id': ...,
    'title': ...,
    'author': ...,
    'category': ...,
    'pages_count': ...,
    'year': ...,
    'metadata': ...
}
```

---

### 3. ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ (main_window.py)

#### 3.1. ูุงุฆูุฉ ุงููุชุจ ุงูุฌุงูุจูุฉ
**ุงูุณุทูุฑ:** 1431-1522

**ุตูุบ ุงูุนุฑุถ:**
- ูุถุน ุงูุณููุงุช: `[ุณูุฉ] ุนููุงู - ูุคูู`
- ูุถุน ุงููุฆุงุช: `ุนููุงู - ูุคูู`
- ุงูุจุญุซ ูู ุงูุนูุงููู: `ุนููุงู - ูุคูู`

#### 3.2. ุฌุฏูู ูุชุงุฆุฌ ุงูุจุญุซ
**ุงูุณุทุฑ:** 1206
```python
self.results_table.setHorizontalHeaderLabels(["ูุณูุณู", "ุงูุณููุงู", "ุงููุชุงุจ", "ุงูุณูุฉ", "ุงูุตููุญุฉ"])
```

**ุงูุณุทูุฑ:** 2126-2155 (ููุก ุงูุฌุฏูู)
```python
book_item = QTableWidgetItem(result['book_title'])  # ุงูุนููุฏ 2
year_item = QTableWidgetItem(result.get('year', '0000'))  # ุงูุนููุฏ 3
```

#### 3.3. ุนููุงู ุงููุงูุฐุฉ ุนูุฏ ูุชุญ ูุชุงุจ
**ุงูุณุทุฑ:** 3453
```python
self.display_header.setText(f"ููุณุชุนุฑุถ ูุชุงุจ [{book['title']}] ูุงูููุงุ ูุนุฏุฏ ุตูุญุงุชู [{total_pages}] ุตูุญุฉ")
```

#### 3.4. ุงูุจุญุซ ูู ุงูุนูุงููู
**ุงูุณุทุฑ:** 1737-1738
```python
# ุงูุจุญุซ ูู ุงูุนููุงู ูุงููุคูู ูุนุงู
full_text = f"{title} {author}".lower()
```

---

### 4. ูุงูุฐุฉ ุชุญููู ุงููุชุงุจ
**ุงูููู:** `features/book_analyzer/analysis_dialog.py`
**ุงูุณุทูุฑ:** 58-114

**ุนุฑุถ ุงููุนูููุงุช:**
```python
title_label = QLabel(f" {self.book_data['title']}")
author_label = QLabel(f" ุงููุคููู: {self.book_data.get('author', 'ุบูุฑ ูุนููู')}")
category_label = QLabel(f" ุงููุฌุงู: {self.book_data.get('category', 'ุบูุฑ ูุตููู')}")
```

---

### 5. ูุงูุฐุฉ ุงูุงูุชุจุงุณ ุงูุฃูุงุฏููู
**ุงูููู:** `ui/citation_dialog.py`
**ุงูุณุทูุฑ:** 193-220

**ุงุณุชุฎุฏุงู ุงููุนูููุงุช:**
```python
author = self.book_info.get('author', '[ุงููุคูู - ุฃููู ูู ุงูุฅูุชุฑูุช]')
title = self.book_info.get('title', '[ุงูุนููุงู]')
year = self.book_info.get('year', '[ุงูุณูุฉ]')
category = self.book_info.get('category', '')
```

**ุตูุบ ุงูุงูุชุจุงุณ:**
- APA: `Author. (year). Title (p. page). Publisher.`
- MLA: `Author. Title. Publisher, year, p. page.`
- Chicago: `Author. Title. City: Publisher, year, page.`

---

### 6. ูุงูุฐุฉ ุงูุฅุญุตุงุฆูุงุช
**ุงูููู:** `ui/statistics_dialog.py`

#### 6.1. ุชุจููุจ ุงูุญููู ุงููุนุฑููุฉ
**ุงูุณุทูุฑ:** 225-257
```python
self.categories_table.setHorizontalHeaderLabels(["ุงูุชุฑุชูุจ", "ุงูุญูู ุงููุนุฑูู", "ุนุฏุฏ ุงููุชุจ"])
```

#### 6.2. ุชุจููุจ ุงููุคูููู
**ุงูุณุทูุฑ:** 259-291
```python
self.authors_table.setHorizontalHeaderLabels(["ุงูุชุฑุชูุจ", "ุงููุคูู", "ุนุฏุฏ ุงููุชุจ"])
```

#### 6.3. ุงููุธุฑุฉ ุงูุนุงูุฉ
**ุงูุณุทูุฑ:** 356-398
- ุนุฏุฏ ุงููุชุจ
- ุนุฏุฏ ุงูุญููู ุงููุนุฑููุฉ
- ุนุฏุฏ ุงููุคูููู

#### 6.4. ุงูุชูุฒูุน ุงูุฒููู
**ุงูุณุทูุฑ:** 444-504
- ุฃูุฏู ูุชุงุจ: `ุงูุนููุงู + ุงูุณูุฉ`
- ุฃุญุฏุซ ูุชุงุจ: `ุงูุนููุงู + ุงูุณูุฉ`
- ุชูุฒูุน ุงููุฑูู

---

### 7. ุชุตุฏูุฑ ุงูุชุญููู
**ุงูููู:** `features/book_analyzer/unified_export_analyzer.py`
**ุงูุณุทูุฑ:** 20-27

**ุชุตุฏูุฑ Excel:**
```python
book_info = pd.DataFrame([
    {'ุงููุนูููุฉ': 'ุนููุงู ุงููุชุงุจ', 'ุงููููุฉ': self.book_data.get('title', '')},
    {'ุงููุนูููุฉ': 'ุงููุคูู', 'ุงููููุฉ': self.book_data.get('author', '')},
    {'ุงููุนูููุฉ': 'ุงูุชุตููู', 'ุงููููุฉ': self.book_data.get('category', '')},
    {'ุงููุนูููุฉ': 'ุงูุณูุฉ', 'ุงููููุฉ': self.book_data.get('year', '')},
])
```

---

### 8. ูุงูุฐุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู
**ุงูููู:** `features/ai_assistant/ai_dialog.py`
**ุงูุณุทูุฑ:** 113, 700, 710

```python
def __init__(self, book_title: str, book_text: str, parent=None):
    self.book_title = book_title
    ...
```

**ุงุณุชุฎุฏุงู:**
```python
book_title = book_data.get('title', 'ูุชุงุจ ุบูุฑ ูุนุฑูู')
dialog = AIDialog(book_title, book_text, self)
```

---

### 9. ุงุณุชุนูุงูุงุช ุงูุจุญุซ
**ุงูููู:** `db/sharded_database.py`

#### 9.1. ุงูุจุญุซ ุงูููุทู (regex)
**ุงูุณุทูุฑ:** 78-114
```sql
SELECT p.book_id, p.page_num, p.content, b.title, 
       COALESCE(b.author, 'ูุฌููู'), COALESCE(b.year, '0000')
FROM pages p JOIN books b ON p.book_id = b.id
WHERE ...
```

**ุงูุฅุฑุฌุงุน:**
```python
{
    'book_title': title,
    'author': author,
    'year': year,
    ...
}
```

#### 9.2. ุฌูุจ ูุงุฆูุฉ ุงููุชุจ
**ุงูุณุทุฑ:** 703-734
```python
def get_all_books(self, category: str = None) -> List[Tuple]:
    # Returns: List[Tuple[shard_number, book_id, title, author]]
```

#### 9.3. ุงููุฆุงุช ูุงูุณููุงุช
**ุงูุณุทูุฑ:** 660-680
```python
def get_all_categories() -> List[str]
def get_all_years() -> List[str]
```

---

## ๐ ุฎุทุฉ ุงูุชูููุฐ

### ุงููุฑุญูุฉ 1: ุชุญุฏูุซ ุงูุงุณุชุฎุฑุงุฌ
1. ุชุนุฏูู `converters/txt_converter.py`
   - ุชุญุฏูุซ `extract_metadata()`
   - ุฏุนู ุงูุชูุณูู ุงูุฌุฏูุฏ
   - ุงูุญูุงุธ ุนูู ุงูุชูุงูู ูุน ุงูุชูุณูู ุงููุฏูู

### ุงููุฑุญูุฉ 2: ูุงุนุฏุฉ ุงูุจูุงูุงุช
1. ุงูุชุญูู ูู ุฃู ุฌุฏูู `books` ูุฏุนู ุฌููุน ุงูุญููู ุงููุทููุจุฉ
2. ุฅุถุงูุฉ ุญููู ุฌุฏูุฏุฉ ุฅู ูุฒู (ูุน migration)

### ุงููุฑุญูุฉ 3: ุงููุงุฌูุงุช
1. ุชุญุฏูุซ ุฌููุน ุฃูุงูู ุงูุนุฑุถ (9 ุฃูุงูู ุฑุฆูุณูุฉ)
2. ุงูุชุฃูุฏ ูู ุงูุชูุงูู ูุน ุงูููู ุงูุงูุชุฑุงุถูุฉ

### ุงููุฑุญูุฉ 4: ุงูุงุฎุชุจุงุฑ
1. ุงุฎุชุจุงุฑ ุงุณุชูุฑุงุฏ ูููุงุช ุจุงูุชูุณูู ุงูุฌุฏูุฏ
2. ุงุฎุชุจุงุฑ ุฌููุน ุงููุงุฌูุงุช
3. ุงุฎุชุจุงุฑ ุงูุชูุงูู ุงูุนูุณู

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงููุงููุฉ

### ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
- [ ] `converters/txt_converter.py` - extract_metadata()

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] `db/sharded_database.py` - add_book()
- [ ] `db/database.py` - get_book() (2 ููุงุถุน)
- [ ] `db/database.py` - ุงุณุชุนูุงูุงุช ุงูุจุญุซ

### ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ
- [ ] `ui/main_window.py` - ูุงุฆูุฉ ุงููุชุจ (3 ุฃูุถุงุน)
- [ ] `ui/main_window.py` - ุฌุฏูู ูุชุงุฆุฌ ุงูุจุญุซ
- [ ] `ui/main_window.py` - ุนููุงู ูุชุญ ุงููุชุงุจ
- [ ] `ui/main_window.py` - ุงูุจุญุซ ูู ุงูุนูุงููู

### ุงููุงุฌูุงุช ุงููุฑุนูุฉ
- [ ] `features/book_analyzer/analysis_dialog.py` - ุจุทุงูุฉ ุงููุชุงุจ
- [ ] `ui/citation_dialog.py` - ุงูุงูุชุจุงุณ ุงูุฃูุงุฏููู
- [ ] `ui/statistics_dialog.py` - 4 ุฃูุณุงู
- [ ] `features/book_analyzer/unified_export_analyzer.py` - ุชุตุฏูุฑ Excel
- [ ] `features/ai_assistant/ai_dialog.py` - ุนููุงู ุงููุชุงุจ

### ุงูุจุญุซ ูุงูุงุณุชุนูุงูุงุช
- [ ] `db/sharded_database.py` - search_regex()
- [ ] `db/sharded_database.py` - get_all_books()
- [ ] `db/sharded_database.py` - get_all_categories()
- [ ] `db/sharded_database.py` - get_all_years()

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชูุงูู ุงูุนูุณู:** ูุฌุจ ุฃู ูุนูู ุงููุธุงู ูุน ุงููุชุจ ุงููุฏููุฉ
2. **ุงูููู ุงูุงูุชุฑุงุถูุฉ:** ุงูุญูุงุธ ุนูู ุงูููู ุงูุงูุชุฑุงุถูุฉ ุงูุญุงููุฉ
3. **ุงูุชุฑููุฒ:** ุฌููุน ุงููุตูุต ุจุงูุนุฑุจูุฉ (UTF-8)
4. **ุงูุฃุฏุงุก:** ุนุฏู ุงูุชุฃุซูุฑ ุนูู ุณุฑุนุฉ ุงูุจุญุซ

---

## ๐ฏ ุงูุฎุทูุฉ ุงูุชุงููุฉ

**ุงูุขู ุฃุฎุจุฑูู ุจุงูุชูุณูู ุงูุฌุฏูุฏ ุงูุฐู ุชุฑูุฏู ูู ูููุงุช TXT**

ูุซุงู:
```
ุงูุนููุงู | ...
ุงููุงุชุจ | ...
ุงูุญูู | ...
ุงูุชุงุฑูุฎ | ...
```

ุฃู ุฃู ุตูุบุฉ ุฃุฎุฑู ุชูุถููุง.



